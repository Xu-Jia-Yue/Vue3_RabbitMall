import{i as X,d as w,r as g,o as G,l as O,a as d,c as u,b as e,t as _,F as $,g as x,u as T,j as R,w as b,_ as E,a9 as z,E as Y,v as P,T as V,m as B,X as M,P as C,aa as F,ab as U,y as q,e as m,n as k,V as N,ac as j,ad as J,p as K,f as Q}from"./index-DJ7OPhWL.js";import"./el-input-CE48kumF.js";import{E as W}from"./el-input-number-Dj6zxpiE.js";import{E as Z,a as ee}from"./el-breadcrumb-item-CQD6aAhI.js";import"./event-BE20p1dL.js";const se=t=>X.get("/goods",{params:{id:t}}),te=t=>X.get("/goods/hot",{params:t}),oe={class:"goods-hot"},ne=["src"],ae={class:"name ellipsis"},le={class:"desc ellipsis"},ce={class:"price"},ie=w({__name:"DetailHot",props:{type:{type:Number}},setup(t){const a=T(),s=t,c=g([]),r=async o=>{const{result:n}=await te({id:o,type:s.type,limit:3});c.value=n};return G(()=>{r(a.params.id)}),(o,n)=>{const l=O("RouterLink");return d(),u("div",oe,[e("h3",null,_(s.type===1?"24小时热销榜":"周热销榜"),1),(d(!0),u($,null,x(c.value,i=>(d(),R(l,{class:"goods-item",to:`/detail/${i.id}`,key:i.id},{default:b(()=>[e("img",{src:i.picture,alt:""},null,8,ne),e("p",ae,_(i.name),1),e("p",le,_(i.desc),1),e("p",ce,"¥"+_(i.price),1)]),_:2},1032,["to"]))),128))])}}}),A=E(ie,[["__scopeId","data-v-3cacd57d"]]),de={class:"goods-image"},ue=["src"],re={class:"small"},_e=["onMouseenter"],pe=["src"],ve=w({__name:"DetailImgs",props:["imgList"],setup(t){const a=t,s=g(0),c=I=>{s.value=I},r=g(null),{elementX:o,elementY:n,isOutside:l}=z(r),i=g(0),p=g(0),h=g(0),y=g(0);return Y([o,n,l],()=>{l.value||(o.value>100&&o.value<300&&(i.value=o.value-100),n.value>100&&n.value<300&&(p.value=n.value-100),o.value>300&&(i.value=200),o.value<100&&(i.value=0),n.value>300&&(p.value=200),n.value<100&&(p.value=0),h.value=-i.value*2,y.value=-p.value*2)}),(I,L)=>(d(),u("div",de,[e("div",{class:"middle",ref_key:"target",ref:r},[e("img",{src:a.imgList[s.value],alt:""},null,8,ue),P(e("div",{class:"layer",style:M({left:`${i.value}px`,top:`${p.value}px`})},null,4),[[V,!B(l)]])],512),e("ul",re,[(d(!0),u($,null,x(a.imgList,(S,v)=>(d(),u("li",{key:v,onMouseenter:as=>c(v),class:C({active:v===s.value})},[e("img",{src:S,alt:""},null,8,pe)],42,_e))),128))]),P(e("div",{class:"large",style:M([{backgroundImage:`url(${a.imgList[0]})`,backgroundPositionX:`${h.value}px`,backgroundPositionY:`${y.value}px`}])},null,4),[[V,!B(l)]])]))}}),me=E(ve,[["__scopeId","data-v-f66f7ac9"]]);function he(t){const a=[],s=2**t.length;for(let c=0;c<s;c+=1){const r=[];for(let o=0;o<t.length;o+=1)c&1<<o&&r.push(t[o]);a.push(r)}return a}const D="★",ge=t=>{const a={};return t&&t.length>0&&t.forEach(s=>{if(s.inventory){const c=s.specs.map(o=>o.valueName);he(c).forEach(o=>{const n=o.join(D);a[n]||(a[n]=[]),a[n].push(s.id)})}}),a};function fe(t,a){t&&t.length>0&&t.forEach(s=>{s.values.forEach(c=>{c.disabled=!a[c.name]})})}const H=t=>{const a=[];return t.forEach((s,c)=>{const r=s.values.find(o=>o.selected);r?a[c]=r.name:a[c]=void 0}),a},ke=(t,a)=>{t.forEach((s,c)=>{const r=H(t);s.values.forEach(o=>{if(!o.selected){r[c]=o.name;const n=r.filter(l=>l).join(D);o.disabled=!a[n]}})})},ye={name:"XtxGoodSku",props:{goods:{type:Object,default:()=>({specs:[],skus:[]})}},emits:["change"],setup(t,{emit:a}){let s={};return F(()=>{s=ge(t.goods.skus),fe(t.goods.specs,s)}),{clickSpecs:(r,o)=>{if(o.disabled)return!1;o.selected?o.selected=!1:(r.values.forEach(l=>{l.selected=!1}),o.selected=!0),ke(t.goods.specs,s);const n=H(t.goods.specs).filter(l=>l);if(n.length===t.goods.specs.length){const l=s[n.join(D)][0],i=t.goods.skus.find(p=>p.id===l);a("change",{skuId:i.id,price:i.price,oldPrice:i.oldPrice,inventory:i.inventory,specsText:i.specs.reduce((p,h)=>`${p} ${h.name}：${h.valueName}`,"").trim()})}else a("change",{})}}}},be={class:"goods-sku"},$e=["onClick","src"],xe=["onClick"];function Ie(t,a,s,c,r,o){return d(),u("div",be,[(d(!0),u($,null,x(s.goods.specs,n=>(d(),u("dl",{key:n.id},[e("dt",null,_(n.name),1),e("dd",null,[(d(!0),u($,null,x(n.values,l=>(d(),u($,{key:l.name},[l.picture?(d(),u("img",{key:0,class:C({selected:l.selected,disabled:l.disabled}),onClick:i=>c.clickSpecs(n,l),src:l.picture},null,10,$e)):(d(),u("span",{key:1,class:C({selected:l.selected,disabled:l.disabled}),onClick:i=>c.clickSpecs(n,l)},_(l.name),11,xe))],64))),128))])]))),128))])}const Ee=E(ye,[["render",Ie],["__scopeId","data-v-ec1712d8"]]),f=t=>(K("data-v-d73d5a0e"),t=t(),Q(),t),Se={key:0,class:"xtx-goods-page"},Ce={key:0,class:"container"},we={class:"bread-container"},De={class:"info-container"},Le={class:"goods-info"},Pe={class:"media"},Ve={class:"goods-sales"},Be=f(()=>e("p",null,"销量人气",-1)),Me=f(()=>e("p",null,[e("i",{class:"iconfont icon-task-filling"}),k("销量人气")],-1)),Ne=f(()=>e("p",null,"商品评价",-1)),je=f(()=>e("p",null,[e("i",{class:"iconfont icon-comment-filling"}),k("查看评价")],-1)),Ae=f(()=>e("p",null,"收藏人气",-1)),Xe=f(()=>e("p",null,[e("i",{class:"iconfont icon-favorite-filling"}),k("收藏商品")],-1)),Ge=f(()=>e("p",null,"品牌信息",-1)),Te={key:0},He=f(()=>e("p",null,[e("i",{class:"iconfont icon-dynamic-filling"}),k("品牌主页")],-1)),Oe={class:"spec"},Re={class:"g-name"},ze={class:"g-desc"},Ye={class:"g-price"},Fe=f(()=>e("div",{class:"g-service"},[e("dl",null,[e("dt",null,"促销"),e("dd",null,"12月好物放送，App领券购买直降120元")]),e("dl",null,[e("dt",null,"服务"),e("dd",null,[e("span",null,"无忧退货"),e("span",null,"快速退款"),e("span",null,"免费包邮"),e("a",{href:"javascript:;"},"了解详情")])])],-1)),Ue={class:"goods-footer"},qe={class:"goods-article"},Je={class:"goods-tabs"},Ke=f(()=>e("nav",null,[e("a",null,"商品详情")],-1)),Qe={class:"goods-detail"},We={class:"attrs"},Ze={class:"dt"},es={class:"dd"},ss=["src"],ts={class:"goods-aside"},os={key:1},ns=w({__name:"index",setup(t){const a=T(),s=g({}),c=async p=>{const{result:h}=await se(p);s.value=h},r=U(),o=g(1),n=g({}),l=p=>{n.value=p},i=()=>{n.value.skuId?(r.addCart({id:s.value.id,name:s.value.name,picture:s.value.mainPictures[0],price:s.value.price,count:o.value,skuId:n.value.skuId,attrsText:n.value.specText,selected:!0}),j({type:"success",message:"添加成功"})):j({type:"warning",message:"请选择规格"})};return G(()=>{c(a.params.id)}),q(p=>{c(p.params.id)}),(p,h)=>{const y=Z,I=ee,L=W,S=J;return s.value?(d(),u("div",Se,[s.value.details?(d(),u("div",Ce,[e("div",we,[m(I,{separator:">"},{default:b(()=>[m(y,{to:{path:"/"}},{default:b(()=>[k("首页")]),_:1}),m(y,{to:{path:`/category/${s.value.categories[1].id}`}},{default:b(()=>[k(_(s.value.categories[1].name),1)]),_:1},8,["to"]),m(y,{to:{path:`/category/sub/${s.value.categories[0].id}`}},{default:b(()=>[k(_(s.value.categories[0].name),1)]),_:1},8,["to"]),m(y,null,{default:b(()=>[k(_(s.value.name),1)]),_:1})]),_:1})]),e("div",De,[e("div",null,[e("div",Le,[e("div",Pe,[m(me,{imgList:s.value.mainPictures},null,8,["imgList"]),e("ul",Ve,[e("li",null,[Be,e("p",null,_(s.value.salesCount),1),Me]),e("li",null,[Ne,e("p",null,_(s.value.commentCount)+"+",1),je]),e("li",null,[Ae,e("p",null,_(s.value.collectCount)+"+",1),Xe]),e("li",null,[Ge,s.value.brand?(d(),u("p",Te,_(s.value.brand.name),1)):N("",!0),He])])]),e("div",Oe,[e("p",Re,_(s.value.name),1),e("p",ze,_(s.value.desc),1),e("p",Ye,[e("span",null,_(s.value.oldPrice),1),e("span",null,_(s.value.price),1)]),Fe,m(Ee,{goods:s.value,onChange:l},null,8,["goods"]),m(L,{modelValue:o.value,"onUpdate:modelValue":h[0]||(h[0]=v=>o.value=v),min:1},null,8,["modelValue"]),e("div",null,[m(S,{size:"large",class:"btn",onClick:i},{default:b(()=>[k(" 加入购物车 ")]),_:1})])])]),e("div",Ue,[e("div",qe,[e("div",Je,[Ke,e("div",Qe,[e("ul",We,[(d(!0),u($,null,x(s.value.details.properties,v=>(d(),u("li",{key:v.value},[e("span",Ze,_(v.name),1),e("span",es,_(v.value),1)]))),128))]),(d(!0),u($,null,x(s.value.details.pictures,v=>(d(),u("img",{src:v,key:v,alt:""},null,8,ss))),128))])])]),e("div",ts,[m(A,{type:1}),m(A,{type:2})])])])])])):N("",!0)])):(d(),u("div",os,"加载中..."))}}}),rs=E(ns,[["__scopeId","data-v-d73d5a0e"]]);export{rs as default};
